{"version":3,"sources":["views/Logistik/PengeluaranBarang/PengeluaranBarang.js"],"names":["PengeluaranBarang","props","state","akun_id","localStorage","getItem","nama","permintaan_id","jumlah","modalIsOpen","harga","sewa","this","setState","data","getPermintaanBarangsQuery","loading","permintaanBarangs","map","permintaan","status","key","id","value","kode","data1","getPengeluaranBarangsQuery","no","pengeluaranBarangs","request","tanggal","to","color","size","className","onClick","onDelete","bind","pengeluaran_id","Swal","fire","title","icon","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","then","result","isConfirmed","hapusPengeluaranBarang","variables","refetchQueries","query","nomor","parseInt","substring","newKode","addPengeluaranBarang","getKodeBaru","Date","toLocaleDateString","history","push","toggleModal","hover","bordered","striped","responsive","align","displayPengeluaranBarang","previous","tag","active","next","isOpen","htmlFor","type","name","onChange","e","target","required","vlaue","displayPermintaanBarangs","submit","Component","compose","graphql"],"mappings":"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","file":"static/js/84.759d4eb2.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport {graphql} from 'react-apollo';\nimport { Link, Redirect } from 'react-router-dom';\nimport * as compose from 'lodash.flowright';\nimport Swal from 'sweetalert2';\nimport {hapusPengeluaranBarang, getPermintaanBarangsQuery, getPengeluaranBarangsQuery, addPengeluaranBarang} from '../queries/queries';\nimport { \n  Form,\n  Card, \n  CardBody, \n  CardHeader, \n  Col, \n  Pagination, \n  PaginationItem, \n  PaginationLink, \n  Row, \n  Table,\n  Button,\n  FormGroup,\n  Label,\n  Input,\n  Modal, ModalBody, ModalHeader\n} from 'reactstrap';\n\nclass PengeluaranBarang extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      akun_id: localStorage.getItem(\"user_id\"),\n      nama:'',\n      permintaan_id:'',\n      jumlah: 0,\n      modalIsOpen: false,  \n      harga: 0,\n      sewa: 0,\n    };\n  }\n\n \n  toggleModal(){\n    this.setState({\n      modalIsOpen: ! this.state.modalIsOpen\n    });\n  }\n\n  displayPermintaanBarangs(){\n    var data = this.props.getPermintaanBarangsQuery;\n    if(data.loading){\n      return (<div>Loading Permintaan...</div>);\n    } else {\n      return data.permintaanBarangs.map(permintaan => {\n          if(permintaan.status === 'Disetujui'){\n            return(\n                <option key={permintaan.id} value={permintaan.id}>{permintaan.kode}</option>\n              )\n          }\n      });\n    }\n  }\n\n  displayPengeluaranBarang(){\n    var data1 = this.props.getPengeluaranBarangsQuery;\n    var no = 0;\n    if(data1.loading){\n      return\n    } else {\n      return data1.pengeluaranBarangs.map(request => {\n        no++;\n        return(\n          <tr key={request.id}>\n            <td>{no}</td>\n            <td>{request.kode}</td>\n            <td>{request.tanggal}</td>\n            <td>\n              <Link to={`/pengeluaranBarang/detailPengeluaranBarang/${request.id}`}>\n              <Button color=\"primary\" size=\"sm\">\n                <i className=\"fa fa-file\"></i>\n                </Button>\n              </Link>\n            </td>\n            <td>\n              <Button onClick={this.onDelete.bind(this, request.id)} color=\"danger\" size=\"sm\">\n                <i className=\"fa fa-trash\"></i>\n              </Button>\n            </td>\n          </tr>\n        );\n      });\n    }\n  }\n\n  onDelete(pengeluaran_id){\n    Swal.fire({\n      title: 'Apakah anda Yakin?',\n      icon: 'warning',\n      showCancelButton: true,\n      confirmButtonColor: '#3085d6',\n      cancelButtonColor: '#d33',\n      confirmButtonText: 'Ya, Saya Yakin!'\n    }).then((result) => {\n      if (result.isConfirmed) {\n        this.props.hapusPengeluaranBarang({\n          variables:{\n            id: pengeluaran_id,        \n          },\n          refetchQueries:[{query:getPengeluaranBarangsQuery}],\n        });\n        Swal.fire(\n          'Dihapus!',\n          'Data Barang Telah Dihapus',\n          'success'\n        )\n      }\n    })\n    \n  }\n\n  getKodeBaru(){\n    var newKode = 'PE';\n    var kode = '';\n    var nomor = 1;\n    var data = this.props.getPengeluaranBarangsQuery;\n    data.pengeluaranBarangs.map(request => {\n      if(request.kode !== ''){\n        kode = request.kode\n      } \n    })\n    if(kode !== ''){\n      nomor = parseInt(kode.substring(2,5))+1\n    }\n    if(nomor < 10){\n      kode = newKode+\"00\"+nomor;\n    }else if (nomor >= 10 && nomor < 100){\n      kode = newKode+\"0\"+nomor;\n    }else {\n      kode = newKode+\"\"+nomor;\n    }\n    return kode;\n  }\n\n  submit(){\n    if(this.state.permintaan_id !== ''){\n      this.props.addPengeluaranBarang({\n        variables:{\n          kode: this.getKodeBaru(),\n          tanggal: new Date().toLocaleDateString(),\n          akun_id: this.state.akun_id,\n          permintaan_id: this.state.permintaan_id,\n        },\n        refetchQueries:[{query:getPengeluaranBarangsQuery}],\n      });\n      this.props.history.push(`/pengeluaranBarang/buatPengeluaranBarang/${this.state.permintaan_id}`);\n    }\n  }\n  render() {\n    return (\n      <div className=\"animated fadeIn\">\n        <Row>\n           <Col>\n            <Card>\n              <CardHeader>\n                <i className=\"fa fa-align-justify\"></i>Pengeluaran Barang\n                <Button size=\"sm\" color=\"primary\" className=\"float-right mb-0\" onClick={this.toggleModal.bind(this)}>\n                  <i className=\"fa fa-plus\"></i> Buat Pengeluaran Barang\n                </Button>\n              </CardHeader>\n              <CardBody>\n                <Table hover bordered striped responsive size=\"sm\">\n                  <thead align=\"center\">\n                  <tr>\n                    <th>No</th>\n                    <th>Kode</th>\n                    <th>Tanggal</th>\n                    <th>Detail</th>\n                    <th>Hapus</th>\n                  </tr>\n                  </thead>\n                  <tbody align=\"center\">\n                  {this.displayPengeluaranBarang()}\n                  </tbody>\n                </Table>\n                <nav>\n                  <Pagination>\n                    <PaginationItem><PaginationLink previous tag=\"button\">Prev</PaginationLink></PaginationItem>\n                    <PaginationItem active>\n                      <PaginationLink tag=\"button\">1</PaginationLink>\n                    </PaginationItem>\n                    <PaginationItem><PaginationLink tag=\"button\">2</PaginationLink></PaginationItem>\n                    <PaginationItem><PaginationLink tag=\"button\">3</PaginationLink></PaginationItem>\n                    <PaginationItem><PaginationLink tag=\"button\">4</PaginationLink></PaginationItem>\n                    <PaginationItem><PaginationLink next tag=\"button\">Next</PaginationLink></PaginationItem>\n                  </Pagination>\n                </nav>\n              </CardBody>\n            </Card>\n          </Col>\n        </Row>\n        <Modal isOpen={this.state.modalIsOpen}>\n          <ModalHeader>Pilih Permintaangeluaran</ModalHeader>\n          <ModalBody>\n            <Form>\n              <FormGroup> \n              <Label htmlFor=\"name\">Kode Permintaan Barang</Label>\n                <Input type=\"select\" name=\"id\" onChange={(e) =>this.setState({permintaan_id:e.target.value})} id=\"id\" required>\n                  <option vlaue=\"\">Kode</option>\n                  {this.displayPermintaanBarangs()}\n                </Input>\n              </FormGroup>\n                <Button type=\"submit\" color=\"primary\" onClick={this.submit.bind(this)}>Submit</Button>   \n              <Button color=\"danger\" onClick={this.toggleModal.bind(this)}>Batal</Button>\n            </Form>\n          </ModalBody>  \n        </Modal>\n      </div>\n    ); \n  }\n}\n\nexport default compose(\n  graphql(getPengeluaranBarangsQuery, {name:\"getPengeluaranBarangsQuery\"}),\n  graphql(getPermintaanBarangsQuery, {name:\"getPermintaanBarangsQuery\"}),\n  graphql(addPengeluaranBarang, {name:\"addPengeluaranBarang\"}),\n  graphql(hapusPengeluaranBarang, {name:\"hapusPengeluaranBarang\"}),\n)(PengeluaranBarang);\n"],"sourceRoot":""}